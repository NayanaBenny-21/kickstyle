<link rel="stylesheet" href="/css/style1.css">

<div class="container mt-5 mb-5" id="cartPage">
  <h4 class="fw-bold mb-4">My Cart</h4>

  {{#if cartItems.length}}
  <div class="row g-4">

    <!-- ðŸ§º CART ITEMS -->
    <div class="col-lg-8">
      {{#each cartItems}}
      <div class="card shadow-sm mb-3 border-0 p-3 rounded-3">
        <div class="row g-3 align-items-center">

          <!-- Product Image -->
          <div class="col-4 col-md-3">
            <img src="{{this.image}}" alt="{{this.name}}" class="img-fluid rounded">
          </div>

          <!-- Product Info -->
          <div class="col-8 col-md-6">
            <h6 class="fw-bold mb-1">{{this.name}}</h6>
            <p class="text-muted small mb-1">{{this.brand}}</p>
            <p class="mb-1 small">Size: <strong>{{this.size}}</strong></p>
            <p class="mb-1 small">Color: <strong>{{this.color}}</strong></p>
            <h6 class="fw-semibold text-danger mb-3">â‚¹{{this.price}}</h6>

            <!-- Quantity Controls  -->
            <div class="d-flex justify-content-start align-items-center gap-2">
              <button 
                class="btn btn-outline-dark btn-sm updateQtyBtn" 
                data-product="{{this._id}}" data-variant="{{this.variantId}}" data-change="-1">âˆ’</button>

              <input type="text" value="{{this.quantity}}"  readonly 
                class="form-control form-control-sm text-center" style="width: 45px;">

              <button 
                class="btn btn-outline-dark btn-sm updateQtyBtn" 
                 data-product="{{this._id}}" 
              data-variant="{{this.variantId}}"  data-change="1" >+</button>

              <button 
                class="btn btn-link text-dark text-decoration-none removeItemBtn ms-2" 
                data-product="{{this._id}}" data-variant="{{this.variantId}}"
                title="Remove item">
                <i class="fa-solid fa-trash fs-5"></i>
              </button>
            </div>
          </div>

        </div>
      </div>
      {{/each}}
    </div>

    <!--  ORDER SUMMARY -->
    <div class="col-lg-4">
      <div class="card shadow-sm border-0 p-3 rounded-3">
        <h5 class="fw-bold mb-3">Order Summary</h5>
        <ul class="list-unstyled mb-3">
          {{#each cartItems}}
          <li class="d-flex justify-content-between small mb-2">
            <span>{{this.name}} (x{{this.quantity}})</span>
            <span>â‚¹{{this.totalPrice}}</span>
          </li>
          {{/each}}
        </ul>
        <hr>
        <div class="d-flex justify-content-between fw-semibold">
          <span>Subtotal</span>
          <span>â‚¹{{subTotal}}</span>
        </div>
        <div class="d-flex justify-content-between text-muted small">
          <span>Shipping</span>
          <span>â‚¹{{shippingCharge}}</span>
        </div>
        <div class="d-flex justify-content-between text-muted small">
          <span>Platform Fee</span>
          <span>â‚¹{{platformFee}}</span>
        </div>
        <hr>
        <div class="d-flex justify-content-between fw-bold">
          <span>Total</span>
          <span>â‚¹{{total}}</span>
        </div>

        <div class="mt-4 text-center">
          <button class="btn btn-warning fw-bold text-white w-100" id="placeOrderBtn">
            Place Order
          </button>
        </div>
      </div>
    </div>

  </div>
  {{else}}
  <!-- ðŸ•³ Empty Cart -->
  <div class="text-center mt-5">
    <h5>Your cart is empty</h5>
    <a href="/" class="btn mt-3" style="background-color: rgb(253, 165, 2); color: whitesmoke;">
      Continue Shopping
    </a>
  </div>
  {{/if}}
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/user/cartPage.js"></script>
